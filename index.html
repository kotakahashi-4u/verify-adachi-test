<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶³ç«‹åŒº é£Ÿæ–™å“ç­‰ç‰©ä¾¡é«˜æ”¯æ´çµ¦ä»˜é‡‘ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
            background-color: #e5e7eb; /* bg-gray-200 */
        }
        .chat-bubble {
            max-width: 85%; /* å¹…ã‚’å°‘ã—åºƒã’ã‚‹ */
            border-radius: 1.2rem; /* è§’ä¸¸ã‚’å°‘ã—å¤§ãã */
            padding: 0.8rem 1rem;
            position: relative;
            animation: fadeIn 0.3s ease-out;
            line-height: 1.6;
            white-space: pre-wrap;
            font-size: 0.95rem; /* æ–‡å­—ã‚µã‚¤ã‚ºèª¿æ•´ */
            box-shadow: 0 1px 2px rgba(0,0,0,0.05); /* è»½ã„å½± */
        }
        .bot-bubble {
            background-color: #ffffff;
            color: #1f2937;
            border-top-left-radius: 0; /* å·¦ä¸Šã‚’å°–ã‚‰ã›ã‚‹ */
            margin-right: auto;
        }
        .user-bubble {
            background-color: #0d9488; /* teal-600 */
            color: white;
            border-top-right-radius: 0; /* å³ä¸Šã‚’å°–ã‚‰ã›ã‚‹ */
            margin-left: auto;
        }
        .option-btn {
            transition: all 0.2s;
        }
        .option-btn:active {
            transform: scale(0.95);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<!-- h-screen ã‚’ h-[100dvh] ã«å¤‰æ›´ã—ã€ãƒ¢ãƒã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«ã‚ˆã‚‹ã¯ã¿å‡ºã—ã‚’é˜²æ­¢ -->
<body class="h-[100dvh] flex flex-col max-w-md mx-auto bg-slate-50 shadow-2xl overflow-hidden border-x border-gray-300">

    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="bg-teal-700 text-white px-4 py-3 flex items-center justify-between shadow-md z-10 shrink-0">
        <div class="flex items-center gap-3">
            <div class="bg-white/10 p-1.5 rounded-full backdrop-blur-sm">
                <i class="fa-solid fa-robot text-white text-lg"></i>
            </div>
            <div>
                <h1 class="font-bold text-base tracking-wide">çµ¦ä»˜é‡‘æ¡ˆå†…ãƒœãƒƒãƒˆ</h1>
                <p class="text-[10px] text-teal-100 opacity-90">è¶³ç«‹åŒº 2026å¹´ ç‰©ä¾¡é«˜æ”¯æ´</p>
            </div>
        </div>
        <!-- ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ -->
        <button onclick="resetChat()" class="text-teal-100 hover:text-white hover:bg-white/10 p-2 rounded-full transition" title="æœ€åˆã‹ã‚‰">
            <i class="fa-solid fa-rotate-right"></i>
        </button>
    </header>

    <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
    <main id="chat-container" class="flex-1 overflow-y-auto p-3 space-y-3 bg-[#f0f2f5] relative overscroll-contain">
        <!-- æœ€åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯JSã§è¿½åŠ ã•ã‚Œã¾ã™ -->
    </main>

    <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
    <div class="px-3 py-3 bg-white border-t border-gray-200 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] shrink-0 pb-safe">
        <!-- ã‚¯ã‚¤ãƒƒã‚¯é¸æŠè‚¢ã‚¨ãƒªã‚¢ (æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«) -->
        <div id="options-container" class="flex gap-2 overflow-x-auto pb-3 scrollbar-hide">
            <!-- é¸æŠè‚¢ã¯JSã§å‹•çš„ã«ç”Ÿæˆ -->
        </div>

        <!-- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› -->
        <form id="chat-form" class="flex gap-2 items-center" onsubmit="handleUserSubmit(event)">
            <input 
                type="text" 
                id="user-input" 
                class="flex-1 bg-gray-100 border-0 text-gray-800 rounded-full px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:bg-white transition text-sm appearance-none"
                placeholder="è³ªå•ã‚’å…¥åŠ›..."
            >
            <button 
                type="submit" 
                class="bg-teal-600 hover:bg-teal-700 text-white rounded-full w-10 h-10 flex items-center justify-center transition shadow-sm flex-shrink-0"
            >
                <i class="fa-solid fa-paper-plane text-sm"></i>
            </button>
        </form>
        <p class="text-[10px] text-gray-400 text-center mt-2">
            â€»ãƒ‡ãƒ¢ç”¨ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã§ã™ã€‚è©³ç´°ã¯<a href="https://www.city.adachi.tokyo.jp/" target="_blank" class="underline hover:text-teal-600">è¶³ç«‹åŒºå…¬å¼ã‚µã‚¤ãƒˆ</a>ã¸ã€‚
        </p>
    </div>

    <script>
        // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ (2026å¹´1æœˆæ™‚ç‚¹ã®æƒ…å ±ã«åŸºã¥ã)
        const botData = {
            greetings: [
                "ã“ã‚“ã«ã¡ã¯ï¼è¶³ç«‹åŒºã®ã€Œé£Ÿæ–™å“ç­‰ç‰©ä¾¡é«˜æ”¯æ´çµ¦ä»˜é‡‘ï¼ˆ1äºº1ä¸‡å††ï¼‰ã€ã«ã¤ã„ã¦ã®ã”è³ªå•ã«ãŠç­”ãˆã—ã¾ã™ã€‚",
                "çŸ¥ã‚ŠãŸã„å†…å®¹ã‚’ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰é¸ã¶ã‹ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
            ],
            // é¸æŠè‚¢å®šç¾©
            options: [
                { label: "å¯¾è±¡è€…ã¯ï¼Ÿ", value: "target" },
                { label: "ã„ãã‚‰ï¼Ÿ", value: "amount" },
                { label: "ã„ã¤ï¼Ÿ", value: "schedule" },
                { label: "ç”³è«‹æ–¹æ³•ã¯ï¼Ÿ", value: "apply" },
                { label: "è©æ¬ºã«æ³¨æ„", value: "scam" },
                { label: "å•ã„åˆã‚ã›", value: "contact" }
            ],
            // å›ç­”ãƒ‡ãƒ¼ã‚¿
            answers: {
                target: {
                    title: "å¯¾è±¡è€…ã«ã¤ã„ã¦",
                    text: "ã€å…¨åŒºæ°‘ã€‘ãŒå¯¾è±¡ã§ã™ã€‚\næ‰€å¾—åˆ¶é™ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n\nä»¤å’Œ8å¹´1æœˆ1æ—¥æ™‚ç‚¹ã§è¶³ç«‹åŒºã«ä½æ°‘ç™»éŒ²ãŒã‚ã‚‹æ–¹ãŒå¯¾è±¡ã¨ãªã‚Šã¾ã™ã€‚"
                },
                amount: {
                    title: "çµ¦ä»˜é¡ã«ã¤ã„ã¦",
                    text: "åŒºæ°‘1äººã‚ãŸã‚Šã€1ä¸‡å††ã€‘ã§ã™ã€‚\nï¼ˆä¾‹ï¼š4äººå®¶æ—ã®å ´åˆã¯åˆè¨ˆ4ä¸‡å††ï¼‰\n\nç¾é‡‘ã§ã®çµ¦ä»˜ã¨ãªã‚Šã¾ã™ï¼ˆãŠã“ã‚åˆ¸ãªã©ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚"
                },
                schedule: {
                    title: "æ”¯çµ¦æ™‚æœŸã«ã¤ã„ã¦",
                    text: "å¯¾è±¡è€…ã«ã‚ˆã£ã¦æ™‚æœŸãŒç•°ãªã‚Šã¾ã™ã€‚\n\n1. ã€æŒ¯è¾¼äº‹å‰æ¡ˆå†…å¯¾è±¡ï¼ˆä½æ‰€å¾—ä¸–å¸¯ãªã©ï¼‰ã€‘\nä»¤å’Œ8å¹´2æœˆä¸‹æ—¬ä»¥é™\nâ€»2æœˆä¸Šæ—¬ã«æ¡ˆå†…ç™ºé€äºˆå®š\n\n2. ã€ãã®ä»–ã®æ–¹ï¼ˆATMå—å–ï¼‰ã€‘\nä»¤å’Œ8å¹´3æœˆä¸­æ—¬ä»¥é™\nâ€»3æœˆä¸Šæ—¬ã«æ¡ˆå†…ç™ºé€äºˆå®š"
                },
                apply: {
                    title: "å—å–æ–¹æ³•ã«ã¤ã„ã¦",
                    text: "å¤§ããåˆ†ã‘ã¦2ã¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚\n\n1. ã€å£åº§æŒ¯è¾¼ã€‘\nä»¥å‰ã«3ä¸‡å††çµ¦ä»˜é‡‘ã‚’å—ã‘å–ã£ãŸä¸–å¸¯ãªã©ã¯ã€åŸå‰‡æ‰‹ç¶šãä¸è¦ã§ç™»éŒ²å£åº§ã«æŒ¯ã‚Šè¾¼ã¾ã‚Œã¾ã™ã€‚\n\n2. ã€ã‚³ãƒ³ãƒ“ãƒ‹ATMå—å–ã€‘\nä¸Šè¨˜ä»¥å¤–ã®æ–¹ã¯ã€éƒµé€ã•ã‚Œã‚‹æ¡ˆå†…ã‚’ç¢ºèªã—ã€ãŠè¿‘ãã®å¤§æ‰‹ã‚³ãƒ³ãƒ“ãƒ‹éŠ€è¡ŒATMç­‰ã§å—ã‘å–ã‚Šæ‰‹ç¶šãã‚’è¡Œã†äºˆå®šã§ã™ï¼ˆè©³ç´°ã¯3æœˆä¸Šæ—¬ã®æ¡ˆå†…ã‚’ãŠå¾…ã¡ãã ã•ã„ï¼‰ã€‚"
                },
                scam: {
                    title: "âš ï¸ è©æ¬ºã«ã”æ³¨æ„ãã ã•ã„",
                    text: "åŒºå½¹æ‰€ã®è·å“¡ãŒã€çµ¦ä»˜é‡‘ã®ãŸã‚ã«ä»¥ä¸‹ã‚’è¡Œã†ã“ã¨ã¯**çµ¶å¯¾ã«ã‚ã‚Šã¾ã›ã‚“**ã€‚\n\nâŒ ã”è‡ªå®…ã‚’è¨ªå•ã™ã‚‹\nâŒ ATMã®æ“ä½œã‚’ãŠé¡˜ã„ã™ã‚‹\nâŒ å£åº§ã®æš—è¨¼ç•ªå·ã‚’èãå‡ºã™\n\nä¸å¯©ãªé›»è©±ã‚„è¨ªå•ãŒã‚ã£ãŸå ´åˆã¯ã€è­¦å¯Ÿï¼ˆ#9110ï¼‰ã«ã”ç›¸è«‡ãã ã•ã„ã€‚"
                },
                contact: {
                    title: "ãŠå•ã„åˆã‚ã›",
                    text: "è©³ç´°ãªè³ªå•ã¯ã€è¶³ç«‹åŒºã®ã‚³ãƒ¼ãƒ«ã‚»ãƒ³ã‚¿ãƒ¼ã¸ãŠé¡˜ã„ã—ã¾ã™ã€‚\n\nğŸ“ ãŠå•ã„åˆã‚ã›ã‚³ãƒ¼ãƒ«ã‚ã ã¡\né›»è©±ï¼š03-3880-0039\nå—ä»˜æ™‚é–“ï¼šåˆå‰8æ™‚ã€œåˆå¾Œ8æ™‚"
                },
                default: {
                    text: "ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®è³ªå•ã«ã¯ã†ã¾ãç­”ãˆã‚‰ã‚Œãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\nä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰é¸ã‚“ã§ã„ãŸã ãã‹ã€ã€ŒãŠå•ã„åˆã‚ã›ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"
                }
            }
        };

        const chatContainer = document.getElementById('chat-container');
        const optionsContainer = document.getElementById('options-container');
        const userInput = document.getElementById('user-input');

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            resetChat();
        });

        function resetChat() {
            chatContainer.innerHTML = '';
            renderOptions();
            
            // å°‘ã—é…ã‚Œã¦æŒ¨æ‹¶ã‚’è¡¨ç¤º
            setTimeout(() => addBotMessage(botData.greetings[0]), 300);
            setTimeout(() => addBotMessage(botData.greetings[1]), 800);
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ ï¼ˆãƒœãƒƒãƒˆï¼‰
        function addBotMessage(text, title = null) {
            const div = document.createElement('div');
            // items-end -> items-start ã«å¤‰æ›´ã—ã¦ã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä¸Šã«é…ç½®
            div.className = 'flex items-start gap-2 mb-2';
            
            let contentHtml = '';
            if (title) {
                contentHtml += `<div class="font-bold text-teal-700 mb-1.5 border-b border-gray-100 pb-1 text-sm">${title}</div>`;
            }
            contentHtml += text;

            div.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm">
                    <i class="fa-solid fa-robot text-teal-600 text-sm"></i>
                </div>
                <div class="chat-bubble bot-bubble text-sm">${contentHtml}</div>`;
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
        function addUserMessage(text) {
            const div = document.createElement('div');
            div.className = 'flex items-start gap-2 mb-4 justify-end'; // justify-endã‚’è¿½åŠ 
            div.innerHTML = `<div class="chat-bubble user-bubble text-sm">${escapeHtml(text)}</div>`;
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        // é¸æŠè‚¢ãƒœã‚¿ãƒ³ã®æç”»
        function renderOptions() {
            optionsContainer.innerHTML = '';
            botData.options.forEach(opt => {
                const btn = document.createElement('button');
                // ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’å°‘ã—èª¿æ•´
                btn.className = 'option-btn bg-white border border-teal-500 text-teal-600 px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap hover:bg-teal-50 shadow-sm';
                btn.textContent = opt.label;
                btn.onclick = () => handleOptionClick(opt.value, opt.label);
                optionsContainer.appendChild(btn);
            });
        }

        // é¸æŠè‚¢ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
        function handleOptionClick(key, label) {
            addUserMessage(label);
            showTypingIndicator();
            
            setTimeout(() => {
                removeTypingIndicator();
                const answer = botData.answers[key];
                if (answer) {
                    addBotMessage(answer.text, answer.title);
                } else {
                    addBotMessage(botData.answers.default.text);
                }
            }, 600);
        }

        // ãƒ†ã‚­ã‚¹ãƒˆé€ä¿¡æ™‚ã®å‡¦ç†
        function handleUserSubmit(e) {
            e.preventDefault();
            const text = userInput.value.trim();
            if (!text) return;

            addUserMessage(text);
            userInput.value = '';
            showTypingIndicator();

            setTimeout(() => {
                removeTypingIndicator();
                const responseKey = analyzeInput(text);
                const answer = botData.answers[responseKey];
                
                if (responseKey === 'default') {
                    addBotMessage(botData.answers.default.text);
                } else {
                    addBotMessage(answer.text, answer.title);
                }
            }, 700);
        }

        // ç°¡æ˜“çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æ
        function analyzeInput(text) {
            const t = text.toLowerCase();
            if (t.includes('å¯¾è±¡') || t.includes('èª°') || t.includes('ä½æ°‘') || t.includes('æ‰€å¾—')) return 'target';
            if (t.includes('ã„ãã‚‰') || t.includes('é‡‘é¡') || t.includes('ä½•å††')) return 'amount';
            if (t.includes('ã„ã¤') || t.includes('æ™‚æœŸ') || t.includes('æ—¥') || t.includes('æŒ¯è¾¼')) return 'schedule';
            if (t.includes('ç”³è«‹') || t.includes('æ–¹æ³•') || t.includes('æ‰‹ç¶šã') || t.includes('atm')) return 'apply';
            if (t.includes('è©æ¬º') || t.includes('é›»è©±') || t.includes('æ€ªã—ã„')) return 'scam';
            if (t.includes('é›»è©±') || t.includes('é€£çµ¡') || t.includes('å•ã„åˆã‚ã›')) return 'contact';
            
            return 'default';
        }

        // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆ...ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
        function showTypingIndicator() {
            const div = document.createElement('div');
            div.id = 'typing-indicator';
            div.className = 'flex items-start gap-2 mb-2'; // items-end -> items-start
            div.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-white border border-gray-200 flex items-center justify-center flex-shrink-0 mt-0.5 shadow-sm">
                    <i class="fa-solid fa-robot text-teal-600 text-sm"></i>
                </div>
                <div class="chat-bubble bot-bubble">
                    <div class="flex gap-1 h-2 items-center my-1">
                        <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0s"></div>
                        <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            `;
            chatContainer.appendChild(div);
            scrollToBottom();
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }
    </script>
</body>
</html>
